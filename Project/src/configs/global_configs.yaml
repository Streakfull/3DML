logs_dir: logs/final_models/evaluations/transformer_fusion
is_train: true
name: 20_views
device: cuda:0
batch_size: 8
n_epochs: 100
append_loss_every: 50
print_every: 150
#print_every: 10
validate_every: 4349
save_every: 500
save_every_nepochs: 10
start_epoch: 0
start_iteration: 0
visualize_every: 1000

model:
  lr: 0.0001
  criterion: DICE_BCE #BCE | DICE | DICE_BCE
  pos_weight: None # weight of positive class
  fusion: Transformer #AVG | TRANSFORMER

  encoder:
    patch_size: 16
    sequence_length: 196
    embedding_dim: 768
    patch_padding: 3

  transformer_encoder:
    d_model: 768
    nhead: 12
    num_layers: 12

  transformer_decoder:
    d_model: 768
    nhead: 12
    num_layers: 8
    num_pos_embeddings: 64

  fusion_decoder:
    d_model: 768
    nhead: 6
    num_layers: 2
    
    
evaluation:
   #ckpt_path: logs/final_models/avg_fusion/checkpoints/epoch-latest.ckpt
   ckpt_path: logs/final_models/transformer_fusion/fusion_transformer_all_ds/checkpoints/epoch-latest.ckpt
#ckpt_path: logs/final_models/avg_fusion/epoch-50.ckpt
